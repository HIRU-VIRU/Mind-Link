<!DOCTYPE html>
<html>
<head>
    <title>Chrome AI API Availability Checker</title>
    <style>
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }
        h1 {
            margin: 0 0 10px 0;
            color: #667eea;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        .api-check {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #ddd;
        }
        .api-check.available {
            border-left-color: #28a745;
            background: #d4edda;
        }
        .api-check.unavailable {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
        .status {
            font-weight: bold;
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
        }
        .status.yes {
            background: #28a745;
            color: white;
        }
        .status.no {
            background: #dc3545;
            color: white;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #5568d3;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 13px;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #fff;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .loading {
            display: inline-block;
            animation: pulse 1.5s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Chrome AI API Checker</h1>
        <p class="subtitle">Check availability of Chrome's Built-in AI APIs</p>

        <div id="chromeInfo"></div>
        
        <h2>API Availability</h2>
        <div id="apiStatus"></div>

        <h2>Run Tests</h2>
        <button onclick="testLanguageModel()">Test LanguageModel API</button>
        <button onclick="testSummarizer()">Test Summarizer API</button>
        <button onclick="testTranslator()">Test Translator API</button>
        <button onclick="testAll()">Run All Tests</button>

        <div id="results"></div>
    </div>

    <script>
        // Display Chrome info
        const chromeVersion = navigator.userAgent.match(/Chrome\/(\d+)/)?.[1] || 'Unknown';
        document.getElementById('chromeInfo').innerHTML = `
            <div class="api-check">
                <strong>Chrome Version:</strong> ${chromeVersion}<br>
                <strong>User Agent:</strong> ${navigator.userAgent}
            </div>
        `;

        // Check API availability
        const apis = {
            'LanguageModel': typeof LanguageModel !== 'undefined',
            'Summarizer': typeof Summarizer !== 'undefined',
            'Translator': typeof Translator !== 'undefined',
            'Rewriter': typeof Rewriter !== 'undefined',
            'self.ai': typeof self.ai !== 'undefined',
            'self.ai.languageModel': !!(self.ai?.languageModel),
            'self.ai.summarizer': !!(self.ai?.summarizer),
            'self.ai.translator': !!(self.ai?.translator),
            'self.ai.rewriter': !!(self.ai?.rewriter),
        };

        let statusHtml = '';
        for (const [api, available] of Object.entries(apis)) {
            const statusClass = available ? 'available' : 'unavailable';
            const statusText = available ? 'yes' : 'no';
            const icon = available ? '‚úÖ' : '‚ùå';
            statusHtml += `
                <div class="api-check ${statusClass}">
                    ${icon} <strong>${api}</strong>
                    <span class="status ${statusText}">${available ? 'Available' : 'Not Available'}</span>
                </div>
            `;
        }
        document.getElementById('apiStatus').innerHTML = statusHtml;

        // Test functions
        async function testLanguageModel() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="result"><div class="loading">‚è≥ Testing LanguageModel API...</div></div>';

            try {
                if (typeof LanguageModel === 'undefined') {
                    throw new Error('LanguageModel API not available');
                }

                console.log('Creating LanguageModel session...');
                const session = await LanguageModel.create({
                    outputLanguage: 'en'
                });

                console.log('Sending test prompt...');
                const response = await session.prompt('Tell me a short joke about AI!');
                
                session.destroy();

                resultsDiv.innerHTML = `
                    <div class="result">
                        <h3>‚úÖ LanguageModel Test: Success!</h3>
                        <p><strong>Prompt:</strong> "Tell me a short joke about AI!"</p>
                        <p><strong>Response:</strong></p>
                        <pre>${response}</pre>
                        <p style="color: #28a745; font-weight: bold;">üéâ LanguageModel API works perfectly!</p>
                    </div>
                `;
            } catch (err) {
                resultsDiv.innerHTML = `
                    <div class="result">
                        <h3>‚ùå LanguageModel Test: Failed</h3>
                        <p><strong>Error:</strong> ${err.message}</p>
                        <pre>${err.stack}</pre>
                    </div>
                `;
            }
        }

        async function testSummarizer() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="result"><div class="loading">‚è≥ Testing Summarizer API...</div></div>';

            try {
                if (typeof Summarizer === 'undefined') {
                    throw new Error('Summarizer API not available');
                }

                console.log('Creating Summarizer...');
                const summarizer = await Summarizer.create({
                    type: 'tl;dr',
                    format: 'plain-text',
                    length: 'short'
                });

                const testText = `Artificial intelligence (AI) has revolutionized how we interact with technology. 
                Machine learning, a subset of AI, enables computers to learn patterns from data without explicit programming. 
                Deep learning, using neural networks with multiple layers, has led to breakthroughs in image recognition, 
                natural language processing, and many other fields. These technologies are becoming increasingly important 
                in our daily lives, from voice assistants to recommendation systems.`;

                console.log('Summarizing text...');
                const summary = await summarizer.summarize(testText);
                
                summarizer.destroy();

                resultsDiv.innerHTML = `
                    <div class="result">
                        <h3>‚úÖ Summarizer Test: Success!</h3>
                        <p><strong>Original Text:</strong></p>
                        <pre>${testText}</pre>
                        <p><strong>Summary:</strong></p>
                        <pre>${summary}</pre>
                        <p style="color: #28a745; font-weight: bold;">üéâ Summarizer API works perfectly!</p>
                    </div>
                `;
            } catch (err) {
                resultsDiv.innerHTML = `
                    <div class="result">
                        <h3>‚ùå Summarizer Test: Failed</h3>
                        <p><strong>Error:</strong> ${err.message}</p>
                        <pre>${err.stack}</pre>
                    </div>
                `;
            }
        }

        async function testTranslator() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="result"><div class="loading">‚è≥ Testing Translator API...</div></div>';

            try {
                if (typeof Translator === 'undefined') {
                    throw new Error('Translator API not available');
                }

                console.log('Checking translation capability...');
                const canTranslate = await Translator.canTranslate({
                    sourceLanguage: 'en',
                    targetLanguage: 'es'
                });

                resultsDiv.innerHTML = `
                    <div class="result">
                        <h3>‚úÖ Translator Test: Success!</h3>
                        <p><strong>Can translate EN‚ÜíES:</strong> ${canTranslate}</p>
                        <p style="color: #28a745; font-weight: bold;">üéâ Translator API is accessible!</p>
                        <p><em>Note: Full translation test skipped to avoid downloading language models.</em></p>
                    </div>
                `;
            } catch (err) {
                resultsDiv.innerHTML = `
                    <div class="result">
                        <h3>‚ùå Translator Test: Failed</h3>
                        <p><strong>Error:</strong> ${err.message}</p>
                        <pre>${err.stack}</pre>
                    </div>
                `;
            }
        }

        async function testAll() {
            await testLanguageModel();
            await new Promise(resolve => setTimeout(resolve, 2000));
            await testSummarizer();
            await new Promise(resolve => setTimeout(resolve, 2000));
            await testTranslator();
        }

        // Auto-check on load
        window.addEventListener('load', () => {
            const anyAvailable = apis.LanguageModel || apis.Summarizer;
            if (!anyAvailable) {
                document.getElementById('results').innerHTML = `
                    <div class="result">
                        <h3>‚ö†Ô∏è No AI APIs Available</h3>
                        <p>Required steps to enable Chrome AI APIs:</p>
                        <ol>
                            <li><strong>Enroll in EPP:</strong> <a href="https://developer.chrome.com/docs/ai/join-epp" target="_blank">Join Early Preview Program</a></li>
                            <li><strong>Download model:</strong> Go to <code>chrome://on-device-internals/</code></li>
                            <li><strong>Enable flags:</strong> Go to <code>chrome://flags</code>
                                <ul>
                                    <li><code>prompt-api-for-gemini-nano</code> ‚Üí Enabled</li>
                                    <li><code>summarization-api-for-gemini-nano</code> ‚Üí Enabled</li>
                                    <li><code>optimization-guide-on-device-model</code> ‚Üí Enabled BypassPerfRequirement</li>
                                </ul>
                            </li>
                            <li><strong>Relaunch Chrome</strong></li>
                        </ol>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
